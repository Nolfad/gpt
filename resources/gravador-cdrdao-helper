#!/usr/bin/env python3
from __future__ import annotations

import os
import sys
from pathlib import Path


def adicionar_grupo(grupo: str, usuario: str) -> int:
    return os.system(f"/usr/sbin/usermod -aG {grupo} {usuario}")


def definir_autosuspend(caminho: str, estado: str) -> int:
    try:
        Path(caminho).write_text(estado)
        return 0
    except Exception:
        return 1


def main() -> int:
    if len(sys.argv) < 2:
        print("Ação não informada", file=sys.stderr)
        return 2
    acao = sys.argv[1]
    if acao == "adicionar_grupo":
        if len(sys.argv) < 4:
            print("Uso: adicionar_grupo <grupo> <usuario>", file=sys.stderr)
            return 2
        return adicionar_grupo(sys.argv[2], sys.argv[3])
    if acao == "autosuspend":
        if len(sys.argv) < 4:
            print("Uso: autosuspend <caminho> <on|auto>", file=sys.stderr)
            return 2
        return definir_autosuspend(sys.argv[2], sys.argv[3])
    print("Ação desconhecida", file=sys.stderr)
    return 2


if __name__ == "__main__":
    sys.exit(main())
